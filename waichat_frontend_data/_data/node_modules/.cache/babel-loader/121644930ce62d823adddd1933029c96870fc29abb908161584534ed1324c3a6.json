{"ast":null,"code":"import React,{useEffect,lazy,Suspense}from'react';import{Routes,Route,Navigate}from'react-router-dom';import styled from'styled-components';import{AuthProvider,useAuth}from'./contexts/AuthContext';import socketService from'./services/socketService';import{ToastContainer}from'react-toastify';import'react-toastify/dist/ReactToastify.css';// Lazy loading dei componenti per ottimizzazione delle performance\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=/*#__PURE__*/lazy(()=>import('./components/Login'));const Register=/*#__PURE__*/lazy(()=>import('./components/Register'));const Chat=/*#__PURE__*/lazy(()=>import('./components/Chat'));const AdminPanel=/*#__PURE__*/lazy(()=>import(\"./components/admin/AdminPanel\"));const LoadingScreen=styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100vh;\n  width: 100vw;\n  background-color: var(--background-color);\n  color: var(--primary-color);\n  font-size: 1.5rem;\n`;// Componente wrapper per route protette\nconst PrivateRoute=_ref=>{let{children}=_ref;const{isAuthenticated,loading}=useAuth();if(loading){return/*#__PURE__*/_jsx(LoadingScreen,{children:\"Caricamento...\"});}return isAuthenticated?children:/*#__PURE__*/_jsx(Navigate,{to:\"/login\"});};// App principale\nconst AppContent=()=>{const{isAuthenticated,user,token}=useAuth();// Connetti socket quando l'utente è autenticato\nuseEffect(()=>{if(isAuthenticated&&token){socketService.connect(token);return()=>{socketService.disconnect();};}},[isAuthenticated,token]);return/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(LoadingScreen,{children:\"Caricamento...\"}),children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(PrivateRoute,{children:user&&user.role===\"admin\"?/*#__PURE__*/_jsx(Navigate,{to:\"/admin\"}):/*#__PURE__*/_jsx(Chat,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:!isAuthenticated?/*#__PURE__*/_jsx(Login,{}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(PrivateRoute,{children:user&&user.role===\"admin\"?/*#__PURE__*/_jsx(AdminPanel,{}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:!isAuthenticated?/*#__PURE__*/_jsx(Register,{}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:isAuthenticated?\"/\":\"/login\"})})]})});};const App=()=>{return/*#__PURE__*/_jsxs(AuthProvider,{children:[/*#__PURE__*/_jsx(AppContent,{}),/*#__PURE__*/_jsx(ToastContainer,{position:\"top-right\",autoClose:5000,hideProgressBar:false,newestOnTop:true,closeOnClick:true,rtl:false,pauseOnFocusLoss:true,draggable:true,pauseOnHover:true,theme:\"colored\"})]});};export default App;","map":{"version":3,"names":["React","useEffect","lazy","Suspense","Routes","Route","Navigate","styled","AuthProvider","useAuth","socketService","ToastContainer","jsx","_jsx","jsxs","_jsxs","Login","Register","Chat","AdminPanel","LoadingScreen","div","PrivateRoute","_ref","children","isAuthenticated","loading","to","AppContent","user","token","connect","disconnect","fallback","path","element","role","App","position","autoClose","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","draggable","pauseOnHover","theme"],"sources":["/app/src/App.js"],"sourcesContent":["import React, { useEffect, lazy, Suspense } from 'react';\nimport { Routes, Route, Navigate } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { AuthProvider, useAuth } from './contexts/AuthContext';\nimport socketService from './services/socketService';\nimport { ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\n// Lazy loading dei componenti per ottimizzazione delle performance\nconst Login = lazy(() => import('./components/Login'));\nconst Register = lazy(() => import('./components/Register'));\nconst Chat = lazy(() => import('./components/Chat'));\nconst AdminPanel = lazy(() => import(\"./components/admin/AdminPanel\"));\n\nconst LoadingScreen = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100vh;\n  width: 100vw;\n  background-color: var(--background-color);\n  color: var(--primary-color);\n  font-size: 1.5rem;\n`;\n\n// Componente wrapper per route protette\nconst PrivateRoute = ({ children }) => {\n  const { isAuthenticated, loading } = useAuth();\n  \n  if (loading) {\n    return <LoadingScreen>Caricamento...</LoadingScreen>;\n  }\n  \n  return isAuthenticated ? children : <Navigate to=\"/login\" />;\n};\n\n// App principale\nconst AppContent = () => {\n  const { isAuthenticated, user, token } = useAuth();\n  \n  // Connetti socket quando l'utente è autenticato\n  useEffect(() => {\n    if (isAuthenticated && token) {\n      socketService.connect(token);\n      \n      return () => {\n        socketService.disconnect();\n      };\n    }\n  }, [isAuthenticated, token]);\n  \n  return (\n    <Suspense fallback={<LoadingScreen>Caricamento...</LoadingScreen>}>\n      <Routes>\n        <Route \n          path=\"/\" \n          element={\n            <PrivateRoute>\n              {user && user.role === \"admin\" ? <Navigate to=\"/admin\" /> : <Chat />}\n            </PrivateRoute>\n          } \n        />\n        <Route path=\"/login\" element={!isAuthenticated ? <Login /> : <Navigate to=\"/\" />} />\n        <Route \n          path=\"/admin\" \n          element={\n            <PrivateRoute>\n              {user && user.role === \"admin\" ? <AdminPanel /> : <Navigate to=\"/\" />}\n            </PrivateRoute>\n          } \n        />\n        <Route path=\"/register\" element={!isAuthenticated ? <Register /> : <Navigate to=\"/\" />} />\n        <Route path=\"*\" element={<Navigate to={isAuthenticated ? \"/\" : \"/login\"} />} />\n      </Routes>\n    </Suspense>\n  );\n};\n\nconst App = () => {\n  return (\n    <AuthProvider>\n      <AppContent />\n      <ToastContainer\n        position=\"top-right\"\n        autoClose={5000}\n        hideProgressBar={false}\n        newestOnTop\n        closeOnClick\n        rtl={false}\n        pauseOnFocusLoss\n        draggable\n        pauseOnHover\n        theme=\"colored\"\n      />\n    </AuthProvider>\n  );\n};\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}